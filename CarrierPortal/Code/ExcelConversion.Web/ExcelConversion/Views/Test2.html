<vr-panel ng-controller="Test2Controller">
    <vr-form name="formFilter" vr-loader="scopeModel.isLoading">
        <vr-validation-group validationcontext="inPutExcelGroupValid">
            <div ng-show="scopeModel.showInputExcelToMap">
                <vr-row removeline>
                    <vr-columns colnum="2">
                        <vr-fileupload extension="xls,xlsx,csv,xlsb" value="scopeModel.inPutFile" label="File to upload" isrequired="true"> </vr-fileupload>
                    </vr-columns>
                </vr-row>
                <vr-row removeline>
                    <vr-columns width="1/2row">
                        <vr-section title="Excel Viewer">
                            <vr-excel-wb fileid="scopeModel.inPutFile.fileId" on-ready="scopeModel.onReadyWoorkBook"></vr-excel-wb>
                        </vr-section>
                    </vr-columns>
                    <vr-columns width="1/2row">
                        <vr-section title="Fields Mapping">
                            <vr-tabs>
                                <vr-tab header="'Codes'">
                                    <excelconversion-listmapping on-ready="scopeModel.onCodeListMappingReady" normal-col-num="4"></excelconversion-listmapping>
                                </vr-tab>
                                <vr-tab header="'Rates'">
                                    <excelconversion-listmapping on-ready="scopeModel.onRateListMappingReady" normal-col-num="4"></excelconversion-listmapping>
                                </vr-tab>
                            </vr-tabs>
                        </vr-section>
                    </vr-columns>
                </vr-row>
            </div>
         </vr-validation-group>
        <vr-validation-group validationcontext="outPutExcelGroupValid">
            <div ng-show="scopeModel.showOutputExcelToMap">
                <vr-row removeline>
                    <vr-columns colnum="2">
                        <vr-fileupload extension="xls,xlsx,csv,xlsb" value="scopeModel.outPutFile" label="File to upload" isrequired="true"> </vr-fileupload>
                    </vr-columns>
                </vr-row>
                <vr-row removeline>
                    <vr-columns width="1/2row">
                        <vr-section title="Excel Viewer">
                            <vr-excel-wb fileid="scopeModel.outPutFile.fileId" on-ready="scopeModel.onOutPutReadyWoorkBook"></vr-excel-wb>
                        </vr-section>
                    </vr-columns>
                    <vr-columns width="1/2row">
                        <vr-section title="Fields Mapping">
                                    <vr-columns colnum="3/4row">
                                        <vr-datagrid datasource="scopeModel.outPutFieldMappings" norowhighlightonclick="true"
                                                     on-ready="onGridReady" hidegridmenu>
                                            <vr-datagridcolumn headertext="'Field Name'" field="'fieldName'" widthfactor="5" disablesorting="true"></vr-datagridcolumn>
                                            <vr-datagridcolumn headertext="'Field Mapping'" widthfactor="15" disablesorting="true">
                                                <excelconversion-fieldmapping-cellfieldmapping on-ready="dataItem.onFieldReady" isrequired="dataItem.isRequired" type="dataItem.type"></excelconversion-fieldmapping-cellfieldmapping>
                                            </vr-datagridcolumn>
                                        </vr-datagrid>
                                    </vr-columns>
                        </vr-section>
                    </vr-columns>
                </vr-row>

            </div>

        </vr-validation-group>
   
            <vr-row>
                <vr-row removeline>
                    <vr-actionbar showcollapsebutton="false">
                        <div transclude-to="buttons">
                            <vr-button type="Next" validationcontext="inPutExcelGroupValid" data-onclick="scopeModel.next" ng-show="scopeModel.showInputExcelToMap"></vr-button>
                            <vr-button type="Back" data-onclick="scopeModel.back"  ng-show="scopeModel.showOutputExcelToMap"></vr-button>
                            <vr-button type="Start" formname="formFilter" validationcontext="formFilter" ng-show="scopeModel.showOutputExcelToMap" data-onclick="scopeModel.convertAndDownload" ></vr-button>
                        </div>
                    </vr-actionbar>
                </vr-row>
            </vr-row>
            <excelconversion-fieldmapping-selective on-ready="scopeModel.onFieldMappingReady" normal-col-num="6"> </excelconversion-fieldmapping-selective>
</vr-form>
</vr-panel>
