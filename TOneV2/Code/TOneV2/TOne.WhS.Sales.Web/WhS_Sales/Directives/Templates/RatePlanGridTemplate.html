<vr-row>
    <vr-columns width="fullrow" vr-loader="isLoading">
        <vr-datagrid on-ready="onGridReady"
                     datasource="zoneItems"
                     loadmoredata="loadMoreData"
                     idfield="ZoneId"
                     norowhighlightonclick="'true'"
                     hidegridmenu
                     getrowstyle="getRowStyle"
                     isdynamicrowstyle="true">

            <vr-datagridcolumn headertext="'Zone'" field="'ZoneName'" type="'Text'" widthfactor="23" disablesorting></vr-datagridcolumn>
            <vr-datagridcolumn headertext="'Product'"
                               field="'EffectiveRoutingProductName'"
                               type="'Text'"
                               isfielddynamic="true"
                               widthfactor="8"
                               disablesorting>
            </vr-datagridcolumn>

            <vr-datagridcolumn headertext="'Route Options'" widthfactor="38.5" disablesorting>
                <div vr-loader="dataItem.isLoadingRouteOptions">
                    <vr-whs-routing-zonerouteoptions on-ready="dataItem.onRouteOptionsReady"></vr-whs-routing-zonerouteoptions>
                </div>
            </vr-datagridcolumn>

            <vr-datagridcolumn ng-repeat="method in costCalculationMethods"
                               headertext="method.Title"
                               field="'Costs[' + $index + ']'"
                               type="'Number'"
                               numberprecision="'LongPrecision'"
                               isfielddynamic="true"
                               columnindex="3 + $index"
                               widthfactor="7"
                               disablesorting>
            </vr-datagridcolumn>

            <vr-datagridcolumn headertext="'Current Rate'"
                               type="'Number'"
                               numberprecision="'LongPrecision'"
                               widthfactor="7"
                               disablesorting>
                <div style="text-align: right">
                    <span ng-if="dataItem.FutureNormalRate != null">
                        <a href="" ng-click="viewScope.onCurrentRateClicked(dataItem)" style="color: purple; text-decoration: underline">{{dataItem.CurrentRate | number: 4}}</a><sup style="text-decoration: none">*</sup>
                    </span>
                    <span ng-if="dataItem.FutureNormalRate == null">{{dataItem.CurrentRate | number: 4}}</span>
                </div>
            </vr-datagridcolumn>

            <vr-datagridcolumn headertext="'Calculated Rate'"
                               field="'CalculatedRate'"
                               type="'Number'"
                               numberprecision="'LongPrecision'"
                               ng-show="rateCalculationMethod"
                               isfielddynamic="true"
                               disablesorting>
            </vr-datagridcolumn>

            <vr-datagridcolumn headertext="'New Rate'" widthfactor="7" disablesorting>
                <vr-textbox type="number"
                            value="dataItem.NewRate"
                            customvalidate="dataItem.validateNewRate()"
                            onvaluechanged="viewScope.onNewRateChanged(dataItem)"
                            onblurtextbox="viewScope.onNewRateBlurred(dataItem)"
                            tonextinput>
                </vr-textbox>
            </vr-datagridcolumn>

            <vr-datagridcolumn isfielddynamic="true" widthfactor="1.5">
                <div style="text-align: left">
                    <span class="{{'glyphicon ' + dataItem.RateChangeTypeIcon}}" title="{{dataItem.RateChangeTypeIconTooltip}}" />
                </div>
            </vr-datagridcolumn>

            <vr-datagridcolumn headertext="'BED'" widthfactor="7" disablesorting>
                <span vr-disabled="true">
                    <vr-datetimepicker type="date" value="dataItem.CurrentRateBED" ng-hide="dataItem.NewRate != null" customvalidate="dataItem.validateRateChangeDates()"></vr-datetimepicker>
                </span>
                <vr-datetimepicker type="date" value="dataItem.NewRateBED" ng-show="dataItem.NewRate != null" customvalidate="dataItem.validateNewRateDates()" isrequired="dataItem.showNewRateBED"></vr-datetimepicker>
            </vr-datagridcolumn>

            <vr-datagridcolumn headertext="'EED'" widthfactor="7" disablesorting>
                <span vr-disabled="!dataItem.IsCurrentRateEditable">
                    <vr-datetimepicker type="date"
                                       value="dataItem.CurrentRateEED"
                                       onvaluechanged="dataItem.onCurrentRateEEDChanged(dataItem)"
                                       ng-hide="dataItem.NewRate != null"
                                       customvalidate="dataItem.validateRateChangeDates()">
                    </vr-datetimepicker>
                </span>
                <vr-datetimepicker type="date" value="dataItem.NewRateEED" ng-show="dataItem.NewRate != null" customvalidate="dataItem.validateNewRateDates()"></vr-datetimepicker>
            </vr-datagridcolumn>

            <vr-datagridexpandablerow>
                <vr-directivetabs tabitems="dataItem.drillDownExtensionObject.drillDownDirectiveTabs"></vr-directivetabs>
            </vr-datagridexpandablerow>

        </vr-datagrid>
    </vr-columns>
</vr-row>
