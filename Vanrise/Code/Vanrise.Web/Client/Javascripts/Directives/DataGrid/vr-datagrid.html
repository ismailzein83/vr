<div class="vr-datagrid" ng-class="ctrl.isMobile ? ctrl.mobileGridView ? 'mobile-grid-view' : 'mobile-list-view' : '' " vr-loader="ctrl.isLoadingMoreData" level="{{ctrl.ngClassLevel}}" alternative-color="{{ctrl.layoutOption.alternativeColor}}" vertical-line="{{ctrl.layoutOption.verticalLine}}" horizontal-line="{{ctrl.layoutOption.horizontalLine}}">
    <vr-choices ng-show="ctrl.updateItems.length > 0" onselectionchanged="ctrl.viewSelectionChanged()" selectedindex="ctrl.selectedView">
        <vr-choice isselected="ctrl.isMainItemsShown">Main View</vr-choice>
        <vr-choice>Updated Items ({{ctrl.updateItems.length}})</vr-choice>
    </vr-choices>
    <div class="vr-datagrid-header" ng-hide="ctrl.hideheader" ng-style="ctrl.headerStyle" style="display: flex" ng-class="ctrl.ngClassLevel">
        <div ng-if="!ctrl.isMobile" style="display:flex;width: 100%;">
            <div ng-if="ctrl.showDraggableRowSection" ng-style="{'width': $parent.ctrl.draggableRowIconWidth, 'display':'inline-flex'}">
            </div>
            <div ng-show="!ctrl.hideGridMenu" class="vr-grid-menu-box hand-cursor out-div" ng-class="{withChoices : ctrl.updateItems.length > 0 , toggledd : ctrl.showgmenu==true }" ng-click="ctrl.toggelGridMenu($event)">
                <span class="vr-grid-menu-h-circle hand-cursor" ng-class="ctrl.ngClassLevel"></span>
                <span class="glyphicon  vr-grid-menu-h-dote hand-cursor">
                    <img src="Client/Images/setting-table.png" />
                </span>

            </div>
            <ul class="vr-grid-menu out-div" ng-show="ctrl.showgmenu==true && ctrl.hideGridMenu == false " click-outside="ctrl.toggelGridMenu($event, false)" outside-if-not="out-div">
                <li role="presentation" class="hand-cursor" vr-disabled="ctrl.isExporting" ng-if="ctrl.showExportAction() && ctrl.exportIsClickable" ng-click="ctrl.onExportClicked()">
                    <span style="padding-left:4px;color:black;text-align:center" aria-hidden="true">Export</span>
                    <img src="../../Client/Javascripts/Directives/Button/images/loader-mask.gif" style="width:14px;margin:0px 3px" ng-show="ctrl.isExporting" />
                </li>
                <li role="presentation" ng-repeat="menuAction in ctrl.getGridMenuActions()" class="hand-cursor" ng-click="ctrl.executeGridAction(menuAction)">
                    <span style="padding-left:4px;color:black;text-align:center" aria-hidden="true">{{menuAction.name}}</span>
                    <img src="../../Client/Javascripts/Directives/Button/images/loader-mask.gif" style="width:14px;margin:0px 3px" ng-show="menuAction.isExecuting" />
                </li>
                <li role="separator" class="divider"></li>
                <li style="color:#000" role="presentation" ng-repeat="colDef in ctrl.columnDefs" ng-if="!colDef.nonHiddable">
                    <a ng-click="ctrl.switchColumnVisibility(colDef)">
                        <span style="float: right; color: #000;" class="vr-gridmenu-checkitem" ng-show="!colDef.isHidden">✔</span>
                        <span style="color:black;text-align:center" aria-hidden="true">{{colDef.name}}</span>
                    </a>
                </li>
            </ul>
            <div style="margin:-2px" ng-style="{'width': ctrl.expandableColumnWidth, 'display':'inline-block'}" ng-if="ctrl.expandableColumnWidth != undefined">

            </div>
            <div ng-style="{'display':'inline-flex', 'width': ctrl.dataColumnsSectionWidth}" ng-class="ctrl.isDraggableColumns?'dragcol':''" ng-sortable="ctrl.headerSortableListener">
                <div ng-repeat="colDef in ctrl.columnDefs" ng-hide="colDef.isHidden" ng-style="{'width': colDef.width, 'display':'inline-block'}">
                    <vr-datagridcell htmltemplate='colDef.headerCellTemplate' ng-hide="colDef.invisibleHeader"></vr-datagridcell>
                </div>
            </div>
            <div ng-if="!ctrl.isMainItemsShown" ng-style="{'width': $parent.ctrl.actionTypeColumnWidth, 'display':'inline-flex'}">
            </div>
            <div ng-if="ctrl.showDeleteRowSection" ng-style="{'width': $parent.ctrl.deleteRowColumnWidth, 'display':'inline-flex'}">
            </div>
        </div>
        <div ng-if="ctrl.isMobile" style="display:flex;width: 100%;">
            <div ng-style="{'display':'flex', 'width': '100%','flex-wrap':'wrap'}" ng-show="ctrl.mobileGridView">
                <div bs-tooltip data-title="{{colDef.name}}" ng-repeat="colDef in ctrl.columnDefs" ng-hide="colDef.isHidden" ng-style="{'width': colDef.mobileWidth, 'display':'inline-flex','flex-grow':'1'}">
                    <vr-datagridcell htmltemplate='colDef.headerCellTemplate' ng-hide="colDef.invisibleHeader"></vr-datagridcell>
                </div>
            </div>

            <div ng-if="ctrl.mobileGridView" ng-show="!ctrl.hideGridMenu" class="vr-grid-menu-box hand-cursor out-div" ng-class="ctrl.ngClassLevel">
                <span style="position: absolute;right: 55px;font-size: 19px;font-weight: bold;border-radius: 4px;" ng-click="ctrl.redrawGridlayout(false)">
                    <span class="glyphicon glyphicon-th-list" ng-show="ctrl.mobileSwitchBtn"></span>
                    <img src="../../Client/Javascripts/Directives/Button/images/loader-mask.gif" ng-show="!ctrl.mobileSwitchBtn" style="width:14px;margin:0px 3px;position: relative;top: -2px;" />
                </span>
                <span style="position: absolute;right: 30px;top:3px;font-size: 17px;font-weight: bold;border-radius: 4px;" ng-click="ctrl.openGridSortingMenuOptions($event)">
                    <span class="glyphicon glyphicon-sort"></span>
                </span>
                <span ng-click="ctrl.openGridMenu($event)" style="position: absolute;right: 4px">
                    <span class="glyphicon glyphicon-align-justify hand-cursor" style="font-size: 20px;"></span>
                </span>
            </div>

            <div ng-if="!ctrl.mobileGridView" ng-show="!ctrl.hideGridMenu" style="display:inline-flex;margin-left: auto;font-size:22px;margin-top:-5px">
                <span style="position: absolute;right: 55px;top:2px;font-size: 17px;font-weight: bold;border-radius: 4px;" ng-click="ctrl.redrawGridlayout(true)">
                    <span class="glyphicon  glyphicon-th" ng-show="ctrl.mobileSwitchBtn"></span>
                    <img src="../../Client/Javascripts/Directives/Button/images/loader-mask.gif" ng-show="!ctrl.mobileSwitchBtn" style="width:14px;margin:0px 3px" />
                </span>
                <span style="position: absolute;right: 30px;top:3px;font-size: 17px;font-weight: bold;border-radius: 4px;" ng-click="ctrl.openGridSortingMenuOptions($event)">
                    <span class="glyphicon glyphicon-sort"></span>
                </span>
                <span ng-click="ctrl.openGridMenu($event)" style="position: absolute;right: 4px">
                    <span class="glyphicon glyphicon-align-justify hand-cursor" style="font-size: 20px;"></span>
                </span>
            </div>
        </div>
    </div>

    <div id="gridBodyContainer" ng-style="ctrl.gridStyle" ng-show="ctrl.isMainItemsShown">
        <div id="gridBody">
            <div ng-class="ctrl.norowhighlightonhover ? 'no-highlight' : ''" class="vr-datagrid-body" style="white-space: nowrap; background-color: Transparent; font-weight: bolder; border-left: 1px solid #D0D0D0; border-right: 1px solid #D0D0D0; " ng-if="ctrl.summaryRowHtml != undefined">
                <div ng-if="!ctrl.isMobile" style="width:100%">
                    <div ng-if="ctrl.showDraggableRowSection" ng-style="{'width': $parent.ctrl.draggableRowIconWidth, 'display':'inline-block'}">
                    </div>
                    <div style="margin:-2px" ng-style="{'width': ctrl.expandableColumnWidth, 'display':'inline-block'}" ng-if="ctrl.expandableColumnWidth != undefined">
                    </div>
                    <div ng-style="{'display':'inline-block', 'width': ctrl.dataColumnsSectionWidth}">
                        <div vr-htmlcompiler="ctrl.summaryRowHtml" style="display: flex;"></div>
                    </div>
                </div>
                <div ng-if="ctrl.isMobile" style="width:100%" class="mobile-grid-row summary-container">
                    <div class="grid-base-row" vr-htmlcompiler="ctrl.summaryRowHtml" style="display: flex;"></div>
                </div>
            </div>
            <div ng-sortable="ctrl.itemsSortable" ng-class="ctrl.dragdropsetting && ctrl.datasource.length==0  ?'empty-vrdatagrid-drop' : '' ">
                <div id="rowSection1" ng-class="ctrl.norowhighlightonhover ? 'no-highlight' : ''" class="vr-datagrid-body" ng-repeat="dataItem in ctrl.datasource">

                </div>
            </div>

        </div>
    </div>
    <div id="gridBodyContainer_2" ng-style="ctrl.gridStyle" ng-show="!ctrl.isMainItemsShown">
        <div id="gridBody_2">
            <div id="rowSection2" ng-class="ctrl.norowhighlightonhover ? 'no-highlight' : ''" class="vr-datagrid-body" ng-repeat="dataItem in ctrl.updateItems">

            </div>
        </div>
    </div>
</div>
<div ng-show="ctrl.showPager && ctrl.pagerSettings.totalDataCount > 5" ng-class="ctrl.ngClassLevel" class="vr-remote-footer">
    <vr-pagination pagersettings="ctrl.pagerSettings" on-ready="ctrl.pagerSettingOnReady"></vr-pagination>
</div>
<div ng-show="!ctrl.hidePagingInfo && !ctrl.showPager &&  ctrl.datasource.length > 0 && ctrl.pagerSettings.totalDataCount > 0 " ng-class="ctrl.ngClassLevel" class="vr-remote-footer">
    <div class="vr-scroll-pager-info"> Total count ({{ctrl.pagerSettings.totalDataCount}})</div>
</div>
<div id="rowTemplate">
    <div class="row-main-content {{dataItem.rowIndex % 2 == 0 ?  'vr-datagrid-body-odd' : ''}}" style="white-space:nowrap" ng-class="$parent.ctrl.getRowCSSClass(dataItem)" ng-style="{'background-color': dataItem.isRowExpanded ? '#F5F5F5 !important' : '', 'font-weight' :dataItem.isRowExpanded ? 'bolder' : 'normal', 'border-right': '1px solid #D0D0D0', 'border-left': '1px solid #D0D0D0', 'display': 'flex'}">
        <div ng-if="!ctrl.isMobile" style="display:flex;width: 100%;">
            <div ng-if="ctrl.showDraggableRowSection && !ctrl.readOnly" ng-style="{'width': $parent.ctrl.draggableRowIconWidth, 'display':'inline-block'}" style="height:24px">
                <i class="glyphicon glyphicon-th-list handeldrag hand-cursor" style="top: calc(50% - 6px); left: 3px"></i>
            </div>
            <div style="margin: -2px; height: 24px" ng-style="{'width': $parent.ctrl.expandableColumnWidth, 'display':'inline-block'}" ng-if="$parent.ctrl.expandableColumnWidth != undefined " ng-class="">
                <div ng-show="ctrl.showExpandCollapseIcon(dataItem)" style="height:24px">
                    <span class="glyphicon glyphicon-menu-right hand-cursor grid-expand-collapse-icon" ng-click="$parent.ctrl.expandRow(dataItem)" ng-show="!dataItem.isRowExpanded"></span>
                    <span class="glyphicon glyphicon-menu-down hand-cursor  grid-expand-collapse-icon" ng-click="$parent.ctrl.collapseRow(dataItem)" ng-show="dataItem.isRowExpanded"></span>
                </div>
            </div>

            <div ng-style="{'display':'inline-block', 'width': $parent.ctrl.dataColumnsSectionWidth}" class="vr-datagrid-row" ng-click="$parent.ctrl.onRowClicked($event,dataItem);showMenu=$parent.ctrl.isActionMenuVisible(dataItem) ; " ng-mouseleave="showMenu = false">
                <div ng-class="::$parent.ctrl.hasDefinedMenuAction(dataItem)?'vr-datagrid-datacells' : ''" class="grid-base-row" vr-htmlcompiler="$parent.ctrl.rowHtml" style="display: flex;"></div>
                <ul role="menu" class="dropdown-menu gid-cell-menu am-fade-and-slide-top" ng-show=" showMenu == true"
                    ng-style="{'position': 'fixed', 'left': ctrl.menuLeft,'top': ctrl.menuTop}">
                    <li role="presentation" ng-if="showMenu==true">
                        <div ng-repeat="action in $parent.ctrl.getMenuActions(dataItem)" class="mark-select action-item" style=" ">
                            <div ng-hide="action.disable" class=" hand-cursor" ng-click="$parent.ctrl.menuActionClicked(action, dataItem)"><span style="font-size:11px">{{action.name}}</span></div>
                        </div>
                    </li>
                </ul>
            </div>
            <div ng-if="!ctrl.isMainItemsShown" ng-style="{'width': $parent.ctrl.actionTypeColumnWidth, 'display':'inline-block', 'position':'relative'}">
                <span ng-style="::$parent.ctrl.cellLayoutStyle" class="span-summary" style="top: 50%; position: absolute; transform: translate(0%,-50%);">  {{ dataItem.actionType}}</span>
            </div>
            <div ng-if="ctrl.showDeleteRowSection &&  !ctrl.readOnly" ng-style="{'width': $parent.ctrl.deleteRowColumnWidth, 'display':'inline-block', 'position':'relative'}">
                <span class="hand-cursor glyphicon glyphicon-remove vr-remove-row" ng-click="ctrl.deleteRowClicked(dataItem)" title="{{ctrl.getRowDeleteIconTitle()}}"></span>
            </div>
        </div>
        <div ng-if="ctrl.isMobile" style="width:100%;position:relative" class="mobile-grid-row">
            <div ng-class="::$parent.ctrl.hasDefinedMenuAction(dataItem)?'vr-datagrid-datacells' : ''" class="grid-base-row" ng-swipe-right="$parent.ctrl.expandRow(dataItem,$event)" vr-htmlcompiler="$parent.ctrl.rowHtml" style="display: flex;">
            </div>
            <div ng-show="dataItem.showRow == false" style="width:100%;position:absolute;height: 100%;background-color: #fff; z-index: 1;top:0px">
                <img src="/Client/images/loadingbar.gif" style="position: absolute;left: calc(50% - 80px);top: 33%;height:6px" />
            </div>
        </div>

    </div>

    <div id="divExpandableRowContent_{{$index}}" class="expandable-row-content {{ ::ctrl.isMobile ?'am-fade-and-slide-left' : ''}}" ng-class="dataItem.isRowExpanded ? 'row-content-expanded':''" ng-show="dataItem.isRowExpanded" style="border-top: 1px solid #D0D0D0; border-right:1px solid #D0D0D0;white-space:nowrap;background-color: #fff;">
        <div ng-if="!ctrl.isMobile" style="width:100%">
            <div style="margin:-2px" ng-style="{'width': $parent.ctrl.expandableColumnWidth, 'display':'inline-block' }"></div>
            <div vr-htmlcompiler="dataItem.expandableRowTemplate" ng-style="{'width': $parent.ctrl.expandableSectionWidth, 'display':'inline-block', 'padding': '5px', 'background-color': '#F5F5F5', 'border-left':'1px solid #D0D0D0'}"></div>
        </div>
        <div ng-if="ctrl.isMobile" style="width:100%" ng-swipe-left="$parent.ctrl.collapseRow(dataItem,$event)">
            <div style="position:relative">
                <button ng-click="$parent.ctrl.collapseRow(dataItem,$event)" style="font-size: 18px;" ng-show="dataItem.isRowExpanded && $parent.ctrl.rowClickDetails ==  false">
                    <span class="glyphicon glyphicon-chevron-left hand-cursor"></span>
                    Back
                </button>
                <button ng-click="$parent.ctrl.openRowContextMenuPopup($event,dataItem)" style="position:absolute;right:0px;font-size: 18px;" ng-if="$parent.ctrl.isActionMenuVisible(dataItem)">
                    <span class="glyphicon glyphicon-align-justify hand-cursor"></span>
                    Actions
                </button>
            </div>
            <div class="grid-base-row row-full-view" style="display: flex;">
                <div ng-repeat="colDef in ctrl.columnDefs">
                    <div ng-style="{ 'width': colDef.mobileWidth, 'display':'inline-flex','vertical-align':'top','border-left': 'none'}" ng-class=" ctrl.getCellContainerClass(dataItem, colDef,true)" class="vr-datagrid-cell-container ng-scope">
                        <div class="mobile-label-container">
                            <label class="mobile-label">{{colDef.name}}: </label>
                        </div>
                        <div>
                            <div class="vr-datagrid-celltext ">
                                <div style="text-align: left;width: 100%;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;">
                                    <span ng-style="::$parent.ctrl.cellLayoutStyle" ng-bind="ctrl.getCellValue(dataItem, colDef) {{colDef.filter}}" ng-class="::dataItem.columnsValues['col_' + colDef.columnId].cellClass" style="white-space: nowrap;">
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div vr-htmlcompiler="dataItem.expandableRowTemplate" ng-style="{'width': 'calc(100% + 15px)', 'display':'inline-block', 'padding': '5px 0px', 'margin':'0px -5px'}"></div>
        </div>
    </div>
</div>