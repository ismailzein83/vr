<vr-form validationcontext="formFilter">
    <div ng-hide="filterSectionCollapsed" vr-loader="isLoading">
        <vr-row removeline>
            <vr-columns width="fullrow">
                <vr-choices-filter selectedindex="selectedFilternIndex">
                    <vr-choice-filter isselected="basicSelected">Basic</vr-choice-filter>
                    <vr-choice-filter isselected="advancedSelected">Advanced</vr-choice-filter>
                </vr-choices-filter>
            </vr-columns>
        </vr-row>

        <vr-row removeline>
            <vr-columns colnum="2" ng-show="scopeModel.groupingDimentions != undefined && scopeModel.groupingDimentions.length>0">
                <vr-select datatextfield="Title" datavaluefield="DimensionName" label="Grouping By" isrequired="scopeModel.isGroupingRequired"
                           entityname="Grouping" selectedvalues="scopeModel.selectedGroupingDimentions" datasource="scopeModel.groupingDimentions " ismultipleselection></vr-select>
            </vr-columns>
            <vr-columns colnum="6" haschildcolumns>
                <vr-timerange hideremoveicon on-ready="scopeModel.onTimeRangeDirectiveReady " width="1/3row" type="longDateTime" from="scopeModel.fromdate" to="scopeModel.todate" period="scopeModel.selectedPeriod" isrequired="false"></vr-timerange>
            </vr-columns>
            <span ng-if="scopeModel.showCurrency">
                <vr-common-currency-selector on-ready="scopeModel.onCurrencySelectorReady" normal-col-num="2" isrequired="true" hideremoveicon></vr-common-currency-selector>
            </span>
            <span ng-repeat="filter in scopeModel.filters">
                <vr-directivewrapper directive="filter.directiveEditor" on-ready="filter.onDirectiveReady" normal-col-num="2" isrequired="filter.isRequired"></vr-directivewrapper>
            </span>
            <vr-columns colnum="4" ng-repeat="legend in scopeModel.legends" withemptyline>
                <vr-legend header="{{legend.Header}}" content="{{legend.Content}}"></vr-legend>
            </vr-columns>
        </vr-row>

        <vr-row removeline ng-if="advancedSelected">
            <vr-columns width="fullrow">
                <vr-section title="Advanced Filter">
                    <vr-row ng-show="scopeModel.expression !=undefined" removeline>
                        <vr-columns width="fullrow"><vr-label isvalue breakline>{{scopeModel.expression}}</vr-label></vr-columns>
                    </vr-row>
                    <vr-row removeline>
                        <vr-columns width="1/4row" class="pull-right">
                            <button type="button" class="btn btn-xs btn-primary" ng-click="scopeModel.addFilter()">
                                <i class="glyphicon glyphicon-pencil"></i> Edit Filter
                            </button>
                        </vr-columns>

                        <vr-columns width="1/4row" class="pull-right">
                            <button type="button" class="btn btn-xs btn-primary" ng-click="scopeModel.resetFilter()" ng-disabled="scopeModel.expression ==undefined">
                                <i class="glyphicon glyphicon-remove"></i> Reset Filter
                            </button>
                        </vr-columns>
                    </vr-row>
                </vr-section>
            </vr-columns>
        </vr-row>
    </div>
    <vr-row removeline>
        <vr-actionbar showcollapsebutton="true" issectioncollapsed="filterSectionCollapsed">
            <div transclude-to="buttons">
                <vr-button type="Search" validationcontext="formFilter" data-onclick="search"></vr-button>
            </div>
        </vr-actionbar>
    </vr-row>
</vr-form>
<div>
    <vr-row ng-if="scopeModel.isLoadedData">
        <vr-columns ng-repeat="widget in scopeModel.widgets" colnum="{{widget.columnWidth.numberOfColumns}}">
            <vr-section title="{{widget.settings.WidgetTitle}}" ng-if="widget.settings.ShowTitle" vr-loader="scopeModel.isLoadingDimensionDirective" collapsible>
                <vr-directivewrapper directive="widget.runtimeEditor" on-ready="widget.onDirectiveReady"></vr-directivewrapper>
            </vr-section>
            <span style="padding-right: 3px;" ng-if="!widget.settings.ShowTitle" vr-loader="scopeModel.isLoadingDimensionDirective">
                <vr-directivewrapper directive="widget.runtimeEditor" on-ready="widget.onDirectiveReady"></vr-directivewrapper>
            </span>
        </vr-columns>
    </vr-row>
</div>
