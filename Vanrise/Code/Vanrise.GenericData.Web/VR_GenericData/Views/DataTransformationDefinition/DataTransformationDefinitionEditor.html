<div vr-modalcontent ng-controller="VR_GenericData_DataTransformationDefinitionEditorController" vr-loader="scopeModal.isLoading" width="'99%'">
    <style type="text/css">
        .stepSequence-check-icon {
            position: absolute;
            right: 15px;
            top: -5px;
            z-index: 1;
        }

        .stepSequence-title {
            padding-left: 4px;
        }

        .step-pproperties-icons .icon {
            width: 10px;
            cursor: default;
            position: absolute;
            top: -25px;
            left:unset;
        }

        .step-pproperties-icons .remove-icon {
            right: 7px;
        }

        .step-pproperties-icons .refresh-icon {
            right: 30px;
        }


        .rtl .step-pproperties-icons .remove-icon {
            right: unset;
            left: 7px;
        }

        .rtl .step-pproperties-icons .refresh-icon {
            right: unset;
            left: 30px;
        }

        .rtl .stepSequence-check-icon {
            right: unset;
            left: 15px;
        }

        .rtl .stepSequence-title {
            padding-left: unset;
            padding-right: 4px;
        }
    </style>
    <vr-modalbody>
        <vr-form validationcontext="dataTransformationDefinitionEditorGroup">
            <vr-tabs>
                <vr-tab header="'Definition'">
                    <vr-row>
                        <vr-columns width="normal">
                            <vr-textbox label="Name" value="scopeModal.name" isrequired></vr-textbox>
                        </vr-columns>
                    </vr-row>
                    <vr-row>
                        <vr-columns width="normal">
                            <vr-textbox label="Title" value="scopeModal.title" isrequired></vr-textbox>
                        </vr-columns>
                    </vr-row>
                    <vr-row>
                        <vr-common-devproject-selector on-ready="scopeModal.onDevProjectSelectorReady" normal-col-num="2"></vr-common-devproject-selector>
                    </vr-row>
                </vr-tab>
                <vr-tab header="'Records'">
                    <vr-row>
                        <vr-columns width="fullrow">
                            <vr-genericdata-datatransformation-recordtype-management on-ready="scopeModal.onDataRecordTypeDirectiveReady"></vr-genericdata-datatransformation-recordtype-management>
                        </vr-columns>
                    </vr-row>
                </vr-tab>
                <vr-tab header="'Transformation Steps'">
                    <vr-row>
                        <vr-columns colnum="2">
                            <vr-section title="Toolbox">
                                <vr-datagrid datasource="scopeModal.stepsDefinition" norowhighlightonclick="true"
                                             on-ready="scopeModal.onGridReady" hidegridmenu>
                                    <vr-datagridcolumn headertext="'Steps'" field="'Title'" widthfactor="5" isclickable="true" onclicked="scopeModal.addStep"></vr-datagridcolumn>
                                </vr-datagrid>
                            </vr-section>
                        </vr-columns>
                        <vr-columns colnum="7">
                            <vr-section title="Steps">
                                <div style="max-height:500px;overflow-y:auto;overflow-x:hidden">
                                    <vr-genericdata-datatransformationdefinition-stepsequencedesign on-ready="scopeModal.onSequenceDirectiveReady"></vr-genericdata-datatransformationdefinition-stepsequencedesign>
                                </div>
                            </vr-section>
                        </vr-columns>
                        <vr-columns colnum="3">
                            <vr-section title="Properties" vr-loader="scopeModal.isLoadingDirective">
                                <vr-row removeline>
                                    <vr-columns width="fullrow" class="step-pproperties-icons">
                                        <i class="glyphicon glyphicon-remove hand-cursor icon remove-icon" ng-click="scopeModal.onEditorRemove()" ng-show="scopeModal.selectedStep !=undefined"></i>
                                        <i class="glyphicon glyphicon-refresh hand-cursor icon refresh-icon" ng-click="scopeModal.refreshEditor()" ng-show="scopeModal.selectedStep !=undefined"></i>

                                    </vr-columns>
                                </vr-row>
                                <vr-row removeline>

                                    <div style="max-height:500px;overflow-y:auto;">
                                        <vr-columns width="fullrow">
                                            <vr-directivewrapper directive="scopeModal.selectedStep.editor" on-ready="scopeModal.onEditorDirectiveReady"></vr-directivewrapper>
                                        </vr-columns>
                                        <vr-columns width="fullrow">
                                            <vr-button type="Apply" data-onclick="scopeModal.applyChanges" standalone ng-show="scopeModal.selectedStep !=undefined"></vr-button>
                                        </vr-columns>
                                    </div>
                                </vr-row>
                            </vr-section>
                        </vr-columns>
                    </vr-row>
                </vr-tab>
            </vr-tabs>
        </vr-form>
    </vr-modalbody>
    <div>
        <vr-actionbar showcollapsebutton="false" issectioncollapsed="false">
            <div transclude-to="buttons">
                <vr-button type="Compile" data-onclick="scopeModal.onCompileClick" haspermission="hasTryCompilePermission"></vr-button>
                <vr-button type="Save" validationcontext="dataTransformationDefinitionEditorGroup" data-onclick="scopeModal.SaveDataTransformationDefinition" haspermission="hasSaveDataTransformationDefinition"></vr-button>
                <vr-button type="Close" data-onclick="scopeModal.close"></vr-button>
            </div>
        </vr-actionbar>

    </div>
</div>
