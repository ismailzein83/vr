<div vr-modalcontent ng-controller="PSTN_BusinessEntity_NormalizationRuleEditorController" vr-loader="isGettingData" width="'40%'">
    <vr-modalbody>
        <vr-form name="formNormalizationRuleEditor">

            <vr-choices>
                <vr-choice isselected="definitionSelected">Definition</vr-choice>
                <vr-choice isselected="criteriaSelected">Criteria</vr-choice>
                <vr-choice isselected="actionsSelected">Actions</vr-choice>
                <vr-choice isselected="scheduleSettingsSelected">Schedule Settings</vr-choice>
            </vr-choices>

            <div ng-show="definitionSelected">
                <vr-row>
                    <vr-columns width="fullrow">
                        <vr-textarea label="Description" value="description"></vr-textarea>
                    </vr-columns>
                </vr-row>
            </div>

            <div ng-show="criteriaSelected">
                <vr-row>
                    <vr-columns width="1/3row">
                        <vr-select label="Switch"
                                   datasource="switches"
                                   selectedvalues="selectedSwitches"
                                   onselectionchanged="onSelectedSwitchesChanged"
                                   datavaluefield="SwitchId"
                                   datatextfield="Name"
                                   entityname="Switch"
                                   ismultipleselection>
                        </vr-select>
                    </vr-columns>

                    <vr-columns width="1/3row">
                        <vr-select label="Trunk"
                                   datasource="getSwitchRelatedTrunks"
                                   selectedvalues="selectedTrunks"
                                   datavaluefield="TrunkId"
                                   datatextfield="Name"
                                   filtername="trunkNameFilter"
                                   entityname="Trunk"
                                   ismultipleselection>
                        </vr-select>
                    </vr-columns>

                    <vr-columns width="1/3row">
                        <vr-select label="Number Type"
                                   datasource="phoneNumberTypes"
                                   selectedvalues="selectedPhoneNumberType"
                                   datavaluefield="value"
                                   datatextfield="description"
                                   entityname="Number Type"
                                   hideremoveicon
                                   isrequired>
                        </vr-select>
                    </vr-columns>

                    <vr-columns width="1/3row">
                        <vr-textbox label="Number Length" value="phoneNumberLength" type="number" maxlength="2" minvalue="1" maxvalue="99"></vr-textbox>
                    </vr-columns>

                    <vr-columns width="1/3row">
                        <vr-textbox label="Number Prefix" value="phoneNumberPrefix"></vr-textbox>
                    </vr-columns>
                </vr-row>
            </div>

            <div ng-show="actionsSelected">
                <vr-row>
                    <vr-columns width="fullrow">
                        <vr-row>
                            <vr-columns width="1/3row">
                                <vr-select label="Action Type"
                                           datasource="normalizationRuleActionSettingsTemplates"
                                           selectedvalues="selectedNormalizationRuleActionSettingsTemplate"
                                           onselectionchanged="onNormalizationRuleActionSettingsTemplateChanged"
                                           datavaluefield="TemplateConfigID"
                                           datatextfield="Name"
                                           entityname="Action Type"
                                           hideremoveicon>
                                </vr-select>
                            </vr-columns>

                            <vr-columns width="1/3row">
                                <div style="top:25px;position:absolute;" vr-disabled="isAddButtonDisabled">
                                    <vr-button type="Add" data-onclick="addNormalizationRuleActionSettingsListItem" standalone></vr-button>
                                </div>
                            </vr-columns>
                        </vr-row>

                        <vr-row>
                            <vr-columns width="fullrow">

                                <ul class="list-group dragbelzone" ng-sortable="itemsSortable" ng-show="normalizationRuleActionSettingsList.length > 0">
                                    <li ng-repeat="item in normalizationRuleActionSettingsList" class="list-group-item list-custom" style="margin:1px;">
                                        <i class="glyphicon glyphicon-th-list handeldrag" style="display:inline-block;vertical-align:middle;float: none;"></i>
                                        <i class="glyphicon glyphicon-remove hand-cursor" style="float:right;padding:5px;cursor:default;" ng-click="removeNormalizationRuleActionSettingsListItem($event, item)"></i>
                                        <div style="display:inline-block; width:100% ">
                                            <vr-directivewrapper directive="item.Editor"
                                                                 behaviorid="item.BehaviorId"
                                                                 onloaded="item.onNormalizationRuleActionSettingsDirectiveAPILoaded">
                                            </vr-directivewrapper>
                                        </div>


                                    </li>
                                </ul>

                            </vr-columns>
                        </vr-row>
                    </vr-columns>
                </vr-row>
            </div>

            <div ng-show="scheduleSettingsSelected">
                <vr-row>
                    <vr-columns width="1/3row">
                        <vr-datetimepicker label="Begin Effective Date" value="beginEffectiveDate" type="dateTime" isrequired></vr-datetimepicker>
                    </vr-columns>

                    <vr-columns width="1/3row">
                        <vr-datetimepicker label="End Effective Date" value="endEffectiveDate" type="dateTime"></vr-datetimepicker>
                    </vr-columns>
                </vr-row>
            </div>

        </vr-form>
    </vr-modalbody>

    <div>
        <vr-actionbar showcollapsebutton="false" issectioncollapsed="false">
            <div transclude-to="buttons">
                <vr-button type="Save" formname="formNormalizationRuleEditor" data-onclick="saveNormalizationRule"></vr-button>
                <vr-button type="Close" data-onclick="close"></vr-button>
            </div>
        </vr-actionbar>
    </div>
</div>
